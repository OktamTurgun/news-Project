{% extends 'news/base.html' %}

{% load static %}
{% load i18n %}

{% block title %}Category: {{ current_category }}{% endblock %}

{% block content %}
<div class="container">
    <div class="row">
        <!-- Main content -->
        <div class="col-md-8">
            <h2>{% blocktrans %}Yangiliklar: {{ current_category|title }}{% endblocktrans %}</h2>
            {% if news_list %}
                {% for news in news_list %}
                    <div class="news_item">
                        <h3><a href="{{ news.get_absolute_url }}">{{ news.get_translated_title }}</a></h3>
                        <p>{{ news.get_translated_content|safe|truncatewords:30 }}</p>
                        <small>{{ news.published_at|date:"d M Y" }}</small>
                        <hr>
                    </div>
                {% endfor %}
            {% else %}
                <p>{% trans "Bu kategoriya bo‘yicha yangiliklar topilmadi." %}</p>
            {% endif %}

            <!-- Pagination (agar ListView paginate_by ishlatilgan bo‘lsa) -->
            {% if is_paginated %}
                <nav aria-label="Page navigation">
                    <ul class="pagination">
                        {% if page_obj.has_previous %}
                            <li><a href="?page={{ page_obj.previous_page_number }}">Previous</a></li>
                        {% endif %}
                        {% for num in paginator.page_range %}
                            {% if page_obj.number == num %}
                                <li class="active"><a href="#">{{ num }}</a></li>
                            {% else %}
                                <li><a href="?page={{ num }}">{{ num }}</a></li>
                            {% endif %}
                        {% endfor %}
                        {% if page_obj.has_next %}
                            <li><a href="?page={{ page_obj.next_page_number }}">Next</a></li>
                        {% endif %}
                    </ul>
                </nav>
            {% endif %}
        </div>

        <!-- Sidebar -->
        <div class="col-md-4">
            <div class="single_sidebar">
                <h2><span>{% trans "Kategoriyalar" %}</span></h2>
                <ul>
                    {% for cat in categories %}
                        <li class="cat-item">
                            <a href="{{ cat.get_absolute_url }}">{{ cat.get_translate_name }}</a>
                        </li>
                    {% endfor %}
                </ul>
            </div>

            <div class="single_sidebar">
                <h2><span>{% trans "Eng so‘nggi yangiliklar" %}</span></h2>
                <ul>
                    {% for news in latest_news %}
                        <li><a href="{{ news.get_absolute_url }}">{{ news.get_transated_title }}</a></li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}
